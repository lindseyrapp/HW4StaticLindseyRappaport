---
import { getEntryBySlug } from 'astro:content';
import { SITE_TITLE } from '../../consts';

const { slug } = Astro.params;

// Load the correct blog post by slug (filename without .md)
const post = await getEntryBySlug('blog', slug);

if (!post) {
	throw new Error(`Post not found for slug: ${slug}`);
}

const { title, pubDate, description } = post.data;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<title>{title} | {SITE_TITLE}</title>
		<meta name="description" content={description} />
	</head>
	<body>
		<header>
			<a href="/">Home</a> / <a href="/blog">Blog</a>
		</header>

		<main>
			<article>
				<h1>{title}</h1>
				<time>{pubDate.toLocaleDateString()}</time>

				<!-- This is the ✨ magic ✨ part — render Markdown properly -->
				<Markdown content={post.body} />
			</article>
		</main>
	</body>
</html>

<style>
	body {
		font-family: Arial, sans-serif;
		margin: 2rem;
		max-width: 800px;
	}
	header a {
		margin-right: 10px;
		text-decoration: none;
		color: #1b79b8;
	}
	h1 {
		margin-top: 0;
	}
	time {
		display: block;
		margin-bottom: 1rem;
		color: #888;
	}
	article {
		line-height: 1.6;
	}
	article h1, article h2, article h3 {
		color: #154768;
	}
	article p, article li {
		margin-bottom: 1rem;
	}
</style>
